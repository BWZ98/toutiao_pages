"use strict";(self["webpackChunktoutiao"]=self["webpackChunktoutiao"]||[]).push([[177],{7893:function(t,e,n){n.d(e,{Z:function(){return d}});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-cell",{scopedSlots:t._u([{key:"title",fn:function(){return[n("div",{staticClass:"title-box"},[n("span",[t._v(t._s(t.art.title))]),1===t.art.cover.type?n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.art.cover.images[0],expression:"art.cover.images[0]"}],staticClass:"thumb",attrs:{alt:""}}):t._e()]),t.art.cover.type>1?n("div",{staticClass:"thumb-box"},t._l(t.art.cover.images,(function(t,e){return n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t,expression:"item"}],key:e,staticClass:"thumb",attrs:{alt:""}})})),0):t._e()]},proxy:!0},{key:"label",fn:function(){return[n("div",{staticClass:"label-box"},[n("div",[n("span",[t._v(t._s(t._f("change")(t.art.aut_name))+t._s(t.art.art_id))]),n("span",[t._v(t._s(t.art.comm_count)+"评论")]),n("span",[t._v(t._s(t.art.pubdate))])]),n("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],attrs:{name:"cross"},on:{click:function(e){return e.stopPropagation(),t.MaskFn.apply(null,arguments)}}})],1)]},proxy:!0}])}),n("div",{on:{click:function(t){t.stopPropagation()}}},[n("van-action-sheet",{attrs:{actions:t.actions,"cancel-text":t.bottomText},on:{close:t.closeFn,cancel:t.onCancel,select:t.onSelect},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}})],1)],1)},s=[];const i=[{name:"不感兴趣"},{name:"反馈垃圾内容"}],c=[{value:0,name:"其它问题"},{value:1,name:"标题夸张"},{value:2,name:"低俗色情"},{value:3,name:"错别字多"},{value:4,name:"旧闻重复"},{value:6,name:"内容不实"},{value:8,name:"侵权"},{value:5,name:"广告软文"},{value:7,name:"涉嫌违法犯罪"}];var l={props:{art:Object,isShow:{type:Boolean,default:!0}},data(){return{show:!1,actions:i,bottomText:"取消"}},methods:{MaskFn(){this.show=!0},onCancel(){"返回"===this.bottomText&&(this.show=!0,this.actions=i,this.bottomText="取消")},onSelect(t){"反馈垃圾内容"===t.name?(this.actions=c,this.bottomText="返回"):"不感兴趣"===t.name?(this.$emit("dislikeFn",this.art.art_id),this.show=!1):(this.$emit("reportFn",this.art.art_id,t.value),this.show=!1)},closeFn(){this.actions=i,this.bottomText="取消"}},filters:{change(t){return t.split("").splice(2,3).join("")}}},o=l,r=n(1001),h=(0,r.Z)(o,a,s,!1,null,"d57e788c",null),d=h.exports},6249:function(t,e,n){n.r(e),n.d(e,{default:function(){return F}});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-container"},[n("div",{staticClass:"nav-container"},[n("van-nav-bar",{attrs:{fixed:""},scopedSlots:t._u([{key:"left",fn:function(){return[n("van-icon",{staticClass:"i-descrip",attrs:{name:"description",color:"#fff"}}),n("span",{staticClass:"text"},[t._v("头条资讯")])]},proxy:!0},{key:"right",fn:function(){return[n("van-icon",{staticClass:"i-search",attrs:{name:"search",color:"#fff"},on:{click:t.searchFn}})]},proxy:!0}])})],1),n("div",{staticClass:"sec-nav"},[n("van-tabs",{attrs:{sticky:"","offset-top":"1.2266667rem","before-change":t.beforeChangeFn},on:{change:t.changeFn},model:{value:t.channelID,callback:function(e){t.channelID=e},expression:"channelID"}},t._l(t.channelList,(function(e){return n("van-tab",{key:e.id,attrs:{title:e.name,name:e.id}},[n("ArticleList",{attrs:{channelID:t.channelID}})],1)})),1),n("van-icon",{staticClass:"moreChannels",attrs:{name:"plus",size:"0.37333334rem"},on:{click:function(e){t.show=!0}}})],1),n("div",[n("van-popup",{staticClass:"editBox",model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("ChannelEdit",{attrs:{userList:t.channelList,unCheckList:t.unCheckChannelList},on:{addChannelEV:t.addChannelFn,removeChannelEV:t.removeChannelFn,closeEV:t.closeFn,changeChannel:t.changeChannelFn}})],1)],1)])},s=[],i=n(6183),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[n("van-list",{attrs:{finished:t.finished,"loading-text":"加载中...","finished-text":"没有更多了","immediate-check":!1,offset:"50"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.articleList,(function(e,a){return n("ArticleItem",{key:a,attrs:{art:e},on:{dislikeFn:t.dislikeFunc,reportFn:t.reportFunc},nativeOn:{click:function(n){return t.itemClickFn(e.art_id)}}})})),1)],1)],1)},l=[],o=n(7893),r=n(8398),h={data(){return{articleList:[],loading:!1,finished:!1,timestamp:+new Date,isLoading:!1}},components:{ArticleItem:o.Z},props:{channelID:Number},async created(){const t=await(0,i.ii)(this.channelID,+new Date);this.articleList=t.data.data.results,this.timestamp=t.data.data.pre_timestamp},methods:{async onLoad(){const t=await(0,i.ii)(this.channelID,this.timestamp);this.articleList=[...this.articleList,...t.data.data.results],this.timestamp=t.data.data.pre_timestamp,this.loading=!1,t.data.data.pre_timestamp||(this.finished=!0)},async onRefresh(){this.articleList=[];const t=await(0,i.ii)(this.channelID,+new Date);this.articleList=t.data.data.results,this.timestamp=t.data.data.pre_timestamp,this.isLoading=!1},async dislikeFunc(t){await(0,i.AJ)(t),(0,r.Z)({type:"success",message:"反馈成功"})},async reportFunc(t,e){await(0,i.sk)(t,e),(0,r.Z)({type:"success",message:"举报成功"})},itemClickFn(t){this.$router.push({path:`/article?art_id=${t}`})}}},d=h,u=n(1001),m=(0,u.Z)(d,c,l,!1,null,null,null),p=m.exports,v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"popup-container"},[n("van-nav-bar",{staticClass:"pop-header",attrs:{title:"频道管理"},scopedSlots:t._u([{key:"right",fn:function(){return[n("van-icon",{attrs:{name:"cross",size:"0.37333334rem",color:"white"},on:{click:t.closeF}})]},proxy:!0}])}),n("div",{staticClass:"my-channel-box"},[n("div",{staticClass:"channel-title"},[t._m(0),n("span",{on:{click:t.editFn}},[t._v(" "+t._s(t.isEdit?"完成":"编辑")+" ")])]),n("van-row",{attrs:{type:"flex"}},t._l(t.userList,(function(e){return n("van-col",{key:e.id,attrs:{span:"6"},on:{click:function(n){return t.userChannelClickFn(e)}}},[n("div",{staticClass:"channel-item van-hairline--surround"},[t._v(" "+t._s(e.name)+" "),n("van-badge",{staticClass:"cross-badge",attrs:{color:"transparent"},scopedSlots:t._u([{key:"content",fn:function(){return[n("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.isEdit&&0!==e.id,expression:"isEdit && obj.id !== 0"}],staticClass:"badge-icon",attrs:{name:"cross",color:"#cfcfcf",size:"0.32rem"}})]},proxy:!0}],null,!0)})],1)])})),1)],1),n("div",{staticClass:"more-channel-box"},[t._m(1),n("van-row",{attrs:{type:"flex"}},t._l(t.unCheckList,(function(e){return n("van-col",{key:e.id,attrs:{span:"6"},on:{click:function(n){return t.moreFn(e)}}},[n("div",{staticClass:"channel-item van-hairline--surround"},[t._v(t._s(e.name))])])})),1)],1)],1)},f=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[t._v("我的频道 "),n("span",{staticClass:"small-title"},[t._v(" 点击进入频道 ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"channel-title"},[n("span",[t._v("点击添加更多频道：")])])}],C={data(){return{isEdit:!1}},methods:{editFn(){this.isEdit=!this.isEdit},moreFn(t){this.isEdit&&this.$emit("addChannelEV",t)},userChannelClickFn(t){this.isEdit?0!==t.id&&this.$emit("removeChannelEV",t):(this.$emit("closeEV"),this.$emit("changeChannel",t))},closeF(){this.$emit("closeEV"),this.isEdit=!1}},props:{userList:Array,unCheckList:Array}},_=C,k=(0,u.Z)(_,v,f,!1,null,"717ee6f8",null),w=k.exports,y={name:"HomeComp",components:{ArticleList:p,ChannelEdit:w},data(){return{channelID:0,channelList:[],allChannelList:[],show:!1,channelScroll:{}}},async created(){const t=await(0,i.lS)();this.channelList=t.data.data.channels;const e=await(0,i.Of)();this.allChannelList=e.data.data.channels},computed:{unCheckChannelList(){const t=new Set,e=[];return this.channelList.forEach((e=>{t.add(e.id)})),this.allChannelList.forEach((n=>{t.has(n.id)||e.push(n)})),e}},methods:{async addChannelFn(t){this.channelList.push(t),await(0,i.w0)(this.channelList)},async removeChannelFn(t){const e=this.channelList.findIndex((e=>e.id===t.id));this.channelList.splice(e,1),await(0,i.Mz)(t.id)},closeFn(){this.show=!1},changeChannelFn(t){this.channelID=t.id},searchFn(){this.$router.push("/search")},scorllFn(){this.$route.meta.scorllT=document.documentElement.scrollTop||document.body.scrollTop},beforeChangeFn(){const t=document.documentElement.scrollTop||document.body.scrollTop;return this.channelScroll[this.channelID]=t,!0},changeFn(){this.$nextTick((()=>{document.documentElement.scrollTop=this.channelScroll[this.channelID]}))}},activated(){window.addEventListener("scroll",this.scorllFn),document.documentElement.scrollTop=this.$route.meta.scorllT},deactivated(){window.removeEventListener("scroll",this.scorllFn)}},x=y,b=(0,u.Z)(x,a,s,!1,null,"05d58878",null),F=b.exports}}]);
//# sourceMappingURL=home.d59a3d86.js.map