(self["webpackChunktoutiao"]=self["webpackChunktoutiao"]||[]).push([[707],{9559:function(t,e,n){"use strict";n.d(e,{Z:function(){return u}});var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-nav-bar",{attrs:{title:t.navTitle,fixed:""},scopedSlots:t._u([{key:"left",fn:function(){return[n("van-icon",{staticClass:"goback",attrs:{name:"arrow-left",color:"white",size:"0.48rem"},on:{click:function(e){return t.$router.back()}}})]},proxy:!0}])})],1)},a=[],i={props:{navTitle:String}},o=i,c=n(1001),s=(0,c.Z)(o,r,a,!1,null,"c4979474",null),u=s.exports},6973:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return k}});var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("NavBar",{attrs:{navTitle:"文章详情"}}),Object.keys(t.artObj).length?n("div",[n("div",{staticClass:"article-container"},[n("h1",{staticClass:"art-title"},[t._v(t._s(t.artObj.title))]),n("van-cell",{attrs:{center:"",title:t.changeName(t.artObj.aut_name,t.artObj.aut_id),label:t.artObj.pubdate},scopedSlots:t._u([{key:"icon",fn:function(){return[n("img",{staticClass:"avatar",attrs:{src:t.artObj.aut_photo,alt:""}})]},proxy:!0},{key:"default",fn:function(){return[n("div",[t.artObj.is_followed?n("van-button",{attrs:{type:"info",size:"mini"},on:{click:function(e){return t.followFn(!0)}}},[t._v("已关注")]):n("van-button",{attrs:{icon:"plus",type:"info",size:"mini",plain:""},on:{click:function(e){return t.followFn(!1)}}},[t._v("关注")])],1)]},proxy:!0}])}),n("van-divider"),n("div",{staticClass:"art-content",domProps:{innerHTML:t._s(t.artObj.content)}}),n("van-divider",[t._v("End")]),n("div",{staticClass:"like-box"},[1===t.artObj.like_count?n("van-button",{attrs:{icon:"good-job",type:"danger",size:"small"},on:{click:function(e){return t.likeFn(!0)}}},[t._v("已点赞")]):n("van-button",{attrs:{icon:"good-job-o",type:"danger",plain:"",size:"small"},on:{click:function(e){return t.likeFn(!1)}}},[t._v("点赞")])],1)],1),n("div",{staticClass:"comment-container"},[n("CommentList")],1)]):n("van-loading",{attrs:{color:"#007bff"}},[t._v("文章加载中...")])],1)},a=[],i=n(6198),o=(n(9600),n(561),n(4916),n(3123),n(8975),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"cmt-list"},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多评论了","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.commentList,(function(e){return n("div",{key:e.com_id,staticClass:"cmt-item"},[n("div",{staticClass:"cmt-header"},[n("div",{staticClass:"cmt-header-left"},[n("img",{staticClass:"avatar",attrs:{src:e.aut_photo,alt:""}}),n("span",{staticClass:"uname"},[t._v(t._s(t.changeName(e.aut_name,e.aut_id)))])]),n("div",{staticClass:"cmt-header-right"},[e.is_liking?n("van-icon",{attrs:{name:"like",size:"0.426667rem",color:"red"},on:{click:function(n){return t.likeFn(!0,e)}}}):n("van-icon",{attrs:{name:"like-o",size:"0.426667rem",color:"gray"},on:{click:function(n){return t.likeFn(!1,e)}}})],1)]),n("div",{staticClass:"cmt-body"},[t._v(" "+t._s(e.content)+" ")]),n("div",{staticClass:"cmt-footer"},[t._v(t._s(e.pubdate))])])})),0)],1),n("div",{class:{"art-cmt-container-1":t.isShowCmtBox,"art-cmt-container-2":!t.isShowCmtBox}},[t.isShowCmtBox?n("div",{staticClass:"add-cmt-box van-hairline--top"},[n("van-icon",{attrs:{name:"arrow-left",size:"0.48rem"},on:{click:function(e){return t.$router.back()}}}),n("div",{staticClass:"ipt-cmt-div",on:{click:t.changeShowFn}},[t._v("发表评论")]),n("div",{staticClass:"icon-box"},[n("van-badge",{attrs:{content:0===t.totalCount?"":t.totalCount,max:"99"}},[n("van-icon",{attrs:{name:"comment-o",size:"0.53333334rem"},on:{click:t.cmtClickFn}})],1),!1===t.isCollect?n("van-icon",{attrs:{name:"star-o",size:"0.53333334rem"},on:{click:function(e){return t.storeFn(!0)}}}):n("van-icon",{attrs:{name:"star",color:"red",size:"0.53333334rem"},on:{click:function(e){return t.storeFn(!1)}}}),n("van-icon",{attrs:{name:"share-o",size:"0.53333334rem"}})],1)],1):n("div",{staticClass:"cmt-box van-hairline--top"},[n("textarea",{directives:[{name:"fofo",rawName:"v-fofo"},{name:"model",rawName:"v-model",value:t.cmtText,expression:"cmtText"}],attrs:{placeholder:"友善评论、理性发言、阳光心灵"},domProps:{value:t.cmtText},on:{blur:t.blurFn,input:function(e){e.target.composing||(t.cmtText=e.target.value)}}}),n("van-button",{attrs:{type:"default",disabled:!t.cmtText.length},on:{click:t.sendFn}},[t._v("发布")])],1)])])}),c=[],s=n(4479),u=(n(2222),n(6183)),l={name:"CommentList",data:function(){return{commentList:[],totalCount:"",isShowCmtBox:!0,cmtText:"",loading:!1,finished:!1,lastID:null,isCollect:!1}},created:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,u.nW)({artID:t.$route.query.art_id});case 2:return n=e.sent,e.next=5,(0,u.$d)(t.$route.query.art_id);case 5:r=e.sent,t.isCollect=r.data.data.is_collected,t.commentList=n.data.data.results,t.totalCount=n.data.data.total_count,t.lastID=n.data.data.last_id,t.totalCount||(t.finished=!0);case 11:case"end":return e.stop()}}),e)})))()},methods:{changeName:function(t,e){if(t)return")"===t[t.length-1]?t.split("").splice(2,3).join("")+e:t},likeFn:function(t,e){return(0,i.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t){n.next=6;break}return e.is_liking=!1,n.next=4,(0,u.VH)(e.com_id);case 4:n.next=9;break;case 6:return e.is_liking=!0,n.next=9,(0,u.Ir)(e.com_id);case 9:case"end":return n.stop()}}),n)})))()},changeShowFn:function(){this.isShowCmtBox=!1},blurFn:function(){var t=this;setTimeout((function(){t.isShowCmtBox=!0}),0)},cmtClickFn:function(){document.querySelector(".like-box").scrollIntoView({behavior:"smooth"})},sendFn:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,u.qQ)({ID:t.$route.query.art_id,con:t.cmtText});case 2:return t.cmtText="",e.next=5,(0,u.nW)({artID:t.$route.query.art_id});case 5:n=e.sent,console.log(n),t.commentList=n.data.data.results,t.totalCount=n.data.data.total_count,t.lastID=n.data.data.last_id,t.cmtClickFn();case 11:case"end":return e.stop()}}),e)})))()},onLoad:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.commentList.length){e.next=10;break}return e.next=3,(0,u.nW)({artID:t.$route.query.art_id,offset:t.lastID});case 3:n=e.sent,t.commentList=[].concat((0,s.Z)(t.commentList),(0,s.Z)(n.data.data.results)),t.lastID=n.data.data.last_id,n.data.data.last_id||(t.finished=!0),t.loading=!1,e.next=11;break;case 10:t.loading=!1;case 11:case"end":return e.stop()}}),e)})))()},storeFn:function(t){var e=this;return(0,i.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t){n.next=6;break}return e.isCollect=!0,n.next=4,(0,u.MZ)(e.$route.query.art_id);case 4:n.next=9;break;case 6:return e.isCollect=!1,n.next=9,(0,u.b3)(e.$route.query.art_id);case 9:case"end":return n.stop()}}),n)})))()}}},d=l,m=n(1001),f=(0,m.Z)(d,o,c,!1,null,"b49d7ada",null),v=f.exports,h=n(9559),p={name:"ArticleDetail",components:{NavBar:h.Z,CommentList:v},data:function(){return{artObj:{}}},created:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,u.$d)(t.$route.query.art_id);case 2:n=e.sent,t.artObj=n.data.data;case 4:case"end":return e.stop()}}),e)})))()},methods:{changeName:function(t,e){if(t)return t.split("").splice(2,3).join("")+e},followFn:function(t){var e=this;return(0,i.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t){n.next=6;break}return e.artObj.is_followed=!1,n.next=4,(0,u.zY)(e.artObj.aut_id);case 4:n.next=9;break;case 6:return e.artObj.is_followed=!0,n.next=9,(0,u.Db)(e.artObj.aut_id);case 9:case"end":return n.stop()}}),n)})))()},likeFn:function(t){var e=this;return(0,i.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t){n.next=6;break}return e.artObj.like_count=0,n.next=4,(0,u.tK)(e.artObj.art_id);case 4:n.next=9;break;case 6:return e.artObj.like_count=1,n.next=9,(0,u.mf)(e.artObj.art_id);case 9:case"end":return n.stop()}}),n)})))()},changeShowFn:function(){this.isShowCmtBox=!1},blurFn:function(){var t=this;setTimeout((function(){t.isShowCmtBox=!0}),0)},cmtNumFn:function(t){this.totalCount=t},cmtClickFn:function(){document.querySelector(".like-box").scrollIntoView({behavior:"smooth"})},sendFn:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,u.qQ)({ID:t.$route.query.art_id,con:t.cmtText});case 2:n=e.sent,t.addedCmt=n.data.data.new_obj,t.cmtText="";case 5:case"end":return e.stop()}}),e)})))()}}},b=p,x=(0,m.Z)(b,r,a,!1,null,"31d86cce",null),k=x.exports},1038:function(t,e,n){var r=n(2109),a=n(8457),i=n(7072),o=!i((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:o},{from:a})},4479:function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t){if(Array.isArray(t))return r(t)}n.d(e,{Z:function(){return s}});n(2526),n(1817),n(1539),n(2165),n(8783),n(3948),n(1038);function i(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}n(7042),n(8309),n(4916),n(7601);function o(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}n(1703);function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t){return a(t)||i(t)||o(t)||c()}}}]);
//# sourceMappingURL=ArticleDetail-legacy.f87b29ce.js.map