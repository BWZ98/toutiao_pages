"use strict";(self["webpackChunktoutiao"]=self["webpackChunktoutiao"]||[]).push([[945],{9559:function(t,e,a){a.d(e,{Z:function(){return c}});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{attrs:{title:t.navTitle,fixed:""},scopedSlots:t._u([{key:"left",fn:function(){return[a("van-icon",{staticClass:"goback",attrs:{name:"arrow-left",color:"white",size:"0.48rem"},on:{click:function(e){return t.$router.back()}}})]},proxy:!0}])})],1)},i=[],r={props:{navTitle:String}},o=r,s=a(1001),l=(0,s.Z)(o,n,i,!1,null,"c4979474",null),c=l.exports},3498:function(t,e,a){a.r(e),a.d(e,{default:function(){return f}});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user-edit-container"},[a("NavBar",{attrs:{navTitle:"编辑资料"}}),a("van-cell-group",{staticClass:"action-card"},[a("van-cell",{attrs:{title:"头像","is-link":"",center:""},scopedSlots:t._u([{key:"default",fn:function(){return[a("van-image",{staticClass:"avatar",attrs:{round:"",src:t.profile.photo},on:{click:t.fileFn}})]},proxy:!0}])}),a("van-cell",{attrs:{title:"用户名","is-link":"",value:t.profile.name},on:{click:t.changeShow}}),a("van-cell",{attrs:{title:"生日","is-link":"",value:t.profile.birthday},on:{click:t.birthdayFn}})],1),a("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"iptFile",attrs:{type:"file",accept:"image/*"},on:{change:t.onFileChange}}),a("van-dialog",{attrs:{title:"修改用户名","show-cancel-button":"",beforeClose:t.beforeCloseFn},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[a("van-field",{attrs:{placeholder:t.profile.name},model:{value:t.newName,callback:function(e){t.newName=e},expression:"newName"}})],1),a("van-popup",{style:{height:"40%"},attrs:{position:"bottom"},model:{value:t.dateShow,callback:function(e){t.dateShow=e},expression:"dateShow"}},[a("van-datetime-picker",{attrs:{type:"date",title:"选择年月日","min-date":t.minDate,"max-date":t.maxDate},on:{cancel:t.dateCancelFn,confirm:t.dateConfirmFn},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)},i=[],r=a(9559),o=a(6183),s=a(8398),l={name:"UserEdit",components:{NavBar:r.Z},data(){return{profile:{},isShow:!1,dateShow:!1,newName:"",minDate:new Date(1900,0,1),maxDate:new Date,currentDate:new Date}},async created(){const t=await(0,o.Fv)();this.profile=t.data.data},methods:{fileFn(){this.$refs.iptFile.click()},async onFileChange(t){if(!t.target.files.length)return;const e=new FormData;e.append("photo",t.target.files[0]);const a=await(0,o.y2)(e);this.$store.commit("SET_USERPHOTO",a.data.data.photo),this.profile.photo=a.data.data.photo},changeShow(){this.isShow=!0},async beforeCloseFn(t,e){if("confirm"===t){const t=/^[a-zA-Z0-9\u4e00-\u9fa5]{1,7}$/;t.test(this.newName)?(await(0,o.$4)({name:this.newName}),this.profile.name=this.newName,e()):(e(!1),(0,s.Z)({type:"warning",message:"用户名只能是1-7位中英文数字的组合"}))}else e()},birthdayFn(){this.dateShow=!0,this.currentDate=new Date(this.profile.birthday)},dateCancelFn(){this.dateShow=!1},async dateConfirmFn(){const t=this.currentDate.getFullYear(),e=this.currentDate.getMonth()+1<10?"0"+(this.currentDate.getMonth()+1):this.currentDate.getMonth()+1,a=this.currentDate.getDate()<10?"0"+this.currentDate.getDate():this.currentDate.getDate(),n=`${t}-${e}-${a}`;await(0,o.$4)({birthday:n}),this.profile.birthday=n,this.dateShow=!1}}},c=l,h=a(1001),u=(0,h.Z)(c,n,i,!1,null,"7f9d48f4",null),f=u.exports}}]);
//# sourceMappingURL=UserEdit.0e661246.js.map