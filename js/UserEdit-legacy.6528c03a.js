"use strict";(self["webpackChunktoutiao"]=self["webpackChunktoutiao"]||[]).push([[945],{9559:function(e,t,n){n.d(t,{Z:function(){return l}});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("van-nav-bar",{attrs:{title:e.navTitle,fixed:""},scopedSlots:e._u([{key:"left",fn:function(){return[n("van-icon",{staticClass:"goback",attrs:{name:"arrow-left",color:"white",size:"0.48rem"},on:{click:function(t){return e.$router.back()}}})]},proxy:!0}])})],1)},r=[],i={props:{navTitle:String}},o=i,c=n(1001),s=(0,c.Z)(o,a,r,!1,null,"c4979474",null),l=s.exports},3498:function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-edit-container"},[n("NavBar",{attrs:{navTitle:"编辑资料"}}),n("van-cell-group",{staticClass:"action-card"},[n("van-cell",{attrs:{title:"头像","is-link":"",center:""},scopedSlots:e._u([{key:"default",fn:function(){return[n("van-image",{staticClass:"avatar",attrs:{round:"",src:e.profile.photo},on:{click:e.fileFn}})]},proxy:!0}])}),n("van-cell",{attrs:{title:"用户名","is-link":"",value:e.profile.name},on:{click:e.changeShow}}),n("van-cell",{attrs:{title:"生日","is-link":"",value:e.profile.birthday},on:{click:e.birthdayFn}})],1),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"iptFile",attrs:{type:"file",accept:"image/*"},on:{change:e.onFileChange}}),n("van-dialog",{attrs:{title:"修改用户名","show-cancel-button":"",beforeClose:e.beforeCloseFn},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}},[n("van-field",{attrs:{placeholder:e.profile.name},model:{value:e.newName,callback:function(t){e.newName=t},expression:"newName"}})],1),n("van-popup",{style:{height:"40%"},attrs:{position:"bottom"},model:{value:e.dateShow,callback:function(t){e.dateShow=t},expression:"dateShow"}},[n("van-datetime-picker",{attrs:{type:"date",title:"选择年月日","min-date":e.minDate,"max-date":e.maxDate},on:{cancel:e.dateCancelFn,confirm:e.dateConfirmFn},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1)],1)},r=[],i=n(6198),o=(n(4916),n(7601),n(8309),n(2222),n(8975),n(9559)),c=n(6183),s=n(8398),l={name:"UserEdit",components:{NavBar:o.Z},data:function(){return{profile:{},isShow:!1,dateShow:!1,newName:"",minDate:new Date(1900,0,1),maxDate:new Date,currentDate:new Date}},created:function(){var e=this;return(0,i.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,c.Fv)();case 2:n=t.sent,e.profile=n.data.data;case 4:case"end":return t.stop()}}),t)})))()},methods:{fileFn:function(){this.$refs.iptFile.click()},onFileChange:function(e){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.target.files.length){n.next=2;break}return n.abrupt("return");case 2:return a=new FormData,a.append("photo",e.target.files[0]),n.next=6,(0,c.y2)(a);case 6:r=n.sent,t.$store.commit("SET_USERPHOTO",r.data.data.photo),t.profile.photo=r.data.data.photo;case 9:case"end":return n.stop()}}),n)})))()},changeShow:function(){this.isShow=!0},beforeCloseFn:function(e,t){var n=this;return(0,i.Z)(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("confirm"!==e){a.next=13;break}if(r=/^[a-zA-Z0-9\u4e00-\u9fa5]{1,7}$/,!r.test(n.newName)){a.next=9;break}return a.next=5,(0,c.$4)({name:n.newName});case 5:n.profile.name=n.newName,t(),a.next=11;break;case 9:t(!1),(0,s.Z)({type:"warning",message:"用户名只能是1-7位中英文数字的组合"});case 11:a.next=14;break;case 13:t();case 14:case"end":return a.stop()}}),a)})))()},birthdayFn:function(){this.dateShow=!0,this.currentDate=new Date(this.profile.birthday)},dateCancelFn:function(){this.dateShow=!1},dateConfirmFn:function(){var e=this;return(0,i.Z)(regeneratorRuntime.mark((function t(){var n,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.currentDate.getFullYear(),a=e.currentDate.getMonth()+1<10?"0"+(e.currentDate.getMonth()+1):e.currentDate.getMonth()+1,r=e.currentDate.getDate()<10?"0"+e.currentDate.getDate():e.currentDate.getDate(),i="".concat(n,"-").concat(a,"-").concat(r),t.next=6,(0,c.$4)({birthday:i});case 6:e.profile.birthday=i,e.dateShow=!1;case 8:case"end":return t.stop()}}),t)})))()}}},u=l,f=n(1001),h=(0,f.Z)(u,a,r,!1,null,"7f9d48f4",null),p=h.exports}}]);
//# sourceMappingURL=UserEdit-legacy.6528c03a.js.map