"use strict";(self["webpackChunktoutiao"]=self["webpackChunktoutiao"]||[]).push([[707],{9559:function(t,a,i){i.d(a,{Z:function(){return l}});var n=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",[i("van-nav-bar",{attrs:{title:t.navTitle,fixed:""},scopedSlots:t._u([{key:"left",fn:function(){return[i("van-icon",{staticClass:"goback",attrs:{name:"arrow-left",color:"white",size:"0.48rem"},on:{click:function(a){return t.$router.back()}}})]},proxy:!0}])})],1)},e=[],s={props:{navTitle:String}},o=s,r=i(1001),c=(0,r.Z)(o,n,e,!1,null,"c4979474",null),l=c.exports},6973:function(t,a,i){i.r(a),i.d(a,{default:function(){return b}});var n=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",[i("NavBar",{attrs:{navTitle:"文章详情"}}),Object.keys(t.artObj).length?i("div",[i("div",{staticClass:"article-container"},[i("h1",{staticClass:"art-title"},[t._v(t._s(t.artObj.title))]),i("van-cell",{attrs:{center:"",title:t.changeName(t.artObj.aut_name,t.artObj.aut_id),label:t.artObj.pubdate},scopedSlots:t._u([{key:"icon",fn:function(){return[i("img",{staticClass:"avatar",attrs:{src:t.artObj.aut_photo,alt:""}})]},proxy:!0},{key:"default",fn:function(){return[i("div",[t.artObj.is_followed?i("van-button",{attrs:{type:"info",size:"mini"},on:{click:function(a){return t.followFn(!0)}}},[t._v("已关注")]):i("van-button",{attrs:{icon:"plus",type:"info",size:"mini",plain:""},on:{click:function(a){return t.followFn(!1)}}},[t._v("关注")])],1)]},proxy:!0}])}),i("van-divider"),i("div",{staticClass:"art-content",domProps:{innerHTML:t._s(t.artObj.content)}}),i("van-divider",[t._v("End")]),i("div",{staticClass:"like-box"},[1===t.artObj.like_count?i("van-button",{attrs:{icon:"good-job",type:"danger",size:"small"},on:{click:function(a){return t.likeFn(!0)}}},[t._v("已点赞")]):i("van-button",{attrs:{icon:"good-job-o",type:"danger",plain:"",size:"small"},on:{click:function(a){return t.likeFn(!1)}}},[t._v("点赞")])],1)],1),i("div",{staticClass:"comment-container"},[i("CommentList")],1)]):i("van-loading",{attrs:{color:"#007bff"}},[t._v("文章加载中...")])],1)},e=[],s=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",[i("div",{staticClass:"cmt-list"},[i("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多评论了","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},t._l(t.commentList,(function(a){return i("div",{key:a.com_id,staticClass:"cmt-item"},[i("div",{staticClass:"cmt-header"},[i("div",{staticClass:"cmt-header-left"},[i("img",{staticClass:"avatar",attrs:{src:a.aut_photo,alt:""}}),i("span",{staticClass:"uname"},[t._v(t._s(t.changeName(a.aut_name,a.aut_id)))])]),i("div",{staticClass:"cmt-header-right"},[a.is_liking?i("van-icon",{attrs:{name:"like",size:"0.426667rem",color:"red"},on:{click:function(i){return t.likeFn(!0,a)}}}):i("van-icon",{attrs:{name:"like-o",size:"0.426667rem",color:"gray"},on:{click:function(i){return t.likeFn(!1,a)}}})],1)]),i("div",{staticClass:"cmt-body"},[t._v(" "+t._s(a.content)+" ")]),i("div",{staticClass:"cmt-footer"},[t._v(t._s(a.pubdate))])])})),0)],1),i("div",{class:{"art-cmt-container-1":t.isShowCmtBox,"art-cmt-container-2":!t.isShowCmtBox}},[t.isShowCmtBox?i("div",{staticClass:"add-cmt-box van-hairline--top"},[i("van-icon",{attrs:{name:"arrow-left",size:"0.48rem"},on:{click:function(a){return t.$router.back()}}}),i("div",{staticClass:"ipt-cmt-div",on:{click:t.changeShowFn}},[t._v("发表评论")]),i("div",{staticClass:"icon-box"},[i("van-badge",{attrs:{content:0===t.totalCount?"":t.totalCount,max:"99"}},[i("van-icon",{attrs:{name:"comment-o",size:"0.53333334rem"},on:{click:t.cmtClickFn}})],1),!1===t.isCollect?i("van-icon",{attrs:{name:"star-o",size:"0.53333334rem"},on:{click:function(a){return t.storeFn(!0)}}}):i("van-icon",{attrs:{name:"star",color:"red",size:"0.53333334rem"},on:{click:function(a){return t.storeFn(!1)}}}),i("van-icon",{attrs:{name:"share-o",size:"0.53333334rem"}})],1)],1):i("div",{staticClass:"cmt-box van-hairline--top"},[i("textarea",{directives:[{name:"fofo",rawName:"v-fofo"},{name:"model",rawName:"v-model",value:t.cmtText,expression:"cmtText"}],attrs:{placeholder:"友善评论、理性发言、阳光心灵"},domProps:{value:t.cmtText},on:{blur:t.blurFn,input:function(a){a.target.composing||(t.cmtText=a.target.value)}}}),i("van-button",{attrs:{type:"default",disabled:!t.cmtText.length},on:{click:t.sendFn}},[t._v("发布")])],1)])])},o=[],r=i(6183),c={name:"CommentList",data(){return{commentList:[],totalCount:"",isShowCmtBox:!0,cmtText:"",loading:!1,finished:!1,lastID:null,isCollect:!1}},async created(){const t=await(0,r.nW)({artID:this.$route.query.art_id}),a=await(0,r.$d)(this.$route.query.art_id);this.isCollect=a.data.data.is_collected,this.commentList=t.data.data.results,this.totalCount=t.data.data.total_count,this.lastID=t.data.data.last_id,this.totalCount||(this.finished=!0)},methods:{changeName(t,a){if(t)return")"===t[t.length-1]?t.split("").splice(2,3).join("")+a:t},async likeFn(t,a){t?(a.is_liking=!1,await(0,r.VH)(a.com_id)):(a.is_liking=!0,await(0,r.Ir)(a.com_id))},changeShowFn(){this.isShowCmtBox=!1},blurFn(){setTimeout((()=>{this.isShowCmtBox=!0}),0)},cmtClickFn(){document.querySelector(".like-box").scrollIntoView({behavior:"smooth"})},async sendFn(){await(0,r.qQ)({ID:this.$route.query.art_id,con:this.cmtText}),this.cmtText="";const t=await(0,r.nW)({artID:this.$route.query.art_id});console.log(t),this.commentList=t.data.data.results,this.totalCount=t.data.data.total_count,this.lastID=t.data.data.last_id,this.cmtClickFn()},async onLoad(){if(this.commentList.length){const t=await(0,r.nW)({artID:this.$route.query.art_id,offset:this.lastID});this.commentList=[...this.commentList,...t.data.data.results],this.lastID=t.data.data.last_id,t.data.data.last_id||(this.finished=!0),this.loading=!1}else this.loading=!1},async storeFn(t){t?(this.isCollect=!0,await(0,r.MZ)(this.$route.query.art_id)):(this.isCollect=!1,await(0,r.b3)(this.$route.query.art_id))}}},l=c,d=i(1001),u=(0,d.Z)(l,s,o,!1,null,"b49d7ada",null),m=u.exports,h=i(9559),v={name:"ArticleDetail",components:{NavBar:h.Z,CommentList:m},data(){return{artObj:{}}},async created(){const t=await(0,r.$d)(this.$route.query.art_id);this.artObj=t.data.data},methods:{changeName(t,a){if(t)return t.split("").splice(2,3).join("")+a},async followFn(t){t?(this.artObj.is_followed=!1,await(0,r.zY)(this.artObj.aut_id)):(this.artObj.is_followed=!0,await(0,r.Db)(this.artObj.aut_id))},async likeFn(t){t?(this.artObj.like_count=0,await(0,r.tK)(this.artObj.art_id)):(this.artObj.like_count=1,await(0,r.mf)(this.artObj.art_id))},changeShowFn(){this.isShowCmtBox=!1},blurFn(){setTimeout((()=>{this.isShowCmtBox=!0}),0)},cmtNumFn(t){this.totalCount=t},cmtClickFn(){document.querySelector(".like-box").scrollIntoView({behavior:"smooth"})},async sendFn(){const t=await(0,r.qQ)({ID:this.$route.query.art_id,con:this.cmtText});this.addedCmt=t.data.data.new_obj,this.cmtText=""}}},f=v,_=(0,d.Z)(f,n,e,!1,null,"31d86cce",null),b=_.exports}}]);
//# sourceMappingURL=ArticleDetail.64bfb775.js.map